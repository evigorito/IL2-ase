ped[1:2, sort(paste0(rep(haps.D$SNP,2), c(".1",".2"))), with=F]
sam
ped[samples$V1[sam], sort(paste0(rep(haps.D$SNP,2), c(".1",".2"))), with=F]
ped[ID %in% samples$V1[sam], sort(paste0(rep(haps.D$SNP,2), c(".1",".2"))), with=F]
samples$V1
sam
samples$V1[sam]
ped$ID
ped[ID %in% c(samples$V1[sam], "s10207617D"),]
head(sam.A)
names(sam.A)
sam.A
levels(sam.A$ACDEF.pair)
class(sam.A$ACDEF.pair)
class(as.factor(sam.A$ACDEF.pair))
levels(as.factor(sam.A$ACDEF.pair))
levels(as.factor(sam.A$ACDEF.pair))
levels(as.factor(sam.A$ACDEF.pair))
sam.A$ACDEF.pair
sam.A$ACDEF.pair
unique(sam.A$ACDEF.pair)
levels(sam.A$ACDEF.pair)
ggplot(sam.A,aes(x=ACDEF.pair, y=ASE.hap2)) + geom_dotplot(binaxis = "y", stackdir = "center", dotsize=0.5)+ theme(axis.text.x = element_text(angle = 45, hjust = 1)) + stat_summary(fun.data=mean_sdl, fun.args = list(mult=1), geom="errorbar", color="red", width=0.2) + geom_hline(yintercept = 50,linetype="dashed")
ggplot(sam.A,aes(x=ACDEF.pair, y=ASE.hap2, shape=Phasing)) + geom_dotplot(binaxis = "y", stackdir = "center", dotsize=0.5)+ theme(axis.text.x = element_text(angle = 45, hjust = 1)) + stat_summary(fun.data=mean_sdl, fun.args = list(mult=1), geom="errorbar", color="red", width=0.2) + geom_hline(yintercept = 50,linetype="dashed")
dim(ped)
dim(alig.prob)
head(alig.prob)
dim(homo)
ped[1:3,1:10,with=F]
length(l1)
list(5,6)
length(list(5,6))
length(l1)
l1[[1]]
l1[[2]]
ped.f[63:66,1:10,with=F]
head(alig.prob)
h.snps[1:10]
as.matrix(homo[,V9:V10])
as.vector(as.matrix(homo[,V9:V10]))
?as.vector
length(h.snps)
length(v)
length(as.list(v))
ped.f[65,1:10,with=F]
ped.f[65,1:10,with=F]
]
v[1:10]
h.snps[1:10]
]
ped.f[nrow(ped.f),(h.snps),
]
l1
ped[65,(h.snps)]
ped <- fread(file="/mrc-bsu/scratch/ev250/ase-il2ra/objects/genoB37no_I_D.txt")
dim(ped)
ped[65,(h.snps)]
ped <- fread(file="/mrc-bsu/scratch/ev250/ase-il2ra/objects/genoB37no_I_D.txt")
ped[65,(h.snps)]
dim(ped)
ped[65,h.snps]
ped[64,h.snps]
ped[64,h.snps,with=F]
ped[65,h.snps,with=F]
dim(ped.f)
ped.f[65,h.snps,with=F]
ped.f[65, h.snps, with=F]
ped.f[65, 1:10, with=F]
class(ped.f)
apply(ped.f,2,class)
class(ped.f)
class(ped.f)
class(ped.f[,1,with=F])
which(apply(ped.f,2,class)!="list")
apply(ped.f,2,class)
ped.f[65,1:10,with=F]
head(map)
head(alig.prob)
?nchar
nchar(alig.prob$V10[1:6])
dim(homo)
map[b37==6035816,]
names(ped.f)[1:10]
ped.f[, c(rs7099852.1,rs7099852.2), with=F]
dim(map)
names(ped.f)[1:10]
pedf.snps[1:10]
length(pedf.snps)
ped.f[, c(rs7099852.1,rs7099852.2), with=F]
ped[, c(rs7099852.1,rs7099852.2), with=F]
ped.f[, c("rs7099852.1","rs7099852.2"), with=F]
ped.f[, c("rs7099852.1","rs7099852.2"), with=F]
head(homo)
dim(homo)
v[1:10]
head(t(as.matrix(homo[,V9:V10])))
ped.f[64:65,]
ped.f[c(1,65),]
ped.f[c(1,65),]
dim(map)
dim(samples)
head(samples)
dim(sam.AS2)
sam.AS
sam.AS2
dim(ped)
dim(ped.g)
ped[1:3,1:10,with=F]
ped.g[1:3,1:10,with=F]
ped.d[1:3,1:10,with=F]
ped.g[1:3,1:10,with=F]
ped.g[1:3,1:10,with=F]
ped1=ped.g
dim(hap)
hap=haps.samp
dim(DT)
DT[1, 1:10,with=F]
haps.sam
ped.g[1:3,1:10,with=F]
hap=haps.sam
dim(hap)
i=1
g
j=1
]
DT[rs10795726.1==0,]
dim(DT)
dim(hap)
names(hap)
hap[1:3,1:10,with=F]
ped1[1:3,1:10,with=F]
dim(rp)
dim(rp)
head(rp)
head(rp)
tail(rp)
length(snps.p)
2*length(snps.p)
488-47
189-47
length(snps.p)
snps.p[1:10]
names(ped)[snps.p[1:10]]
snps.p[1:10]
gsub("\\.[1-2]","",names(ped)[1:7]
gsub("\\.[1-2]","",names(ped))[1:7]

gsub("\\.[1-2]","",names(ped))[1:7]
gsub("\\.[1-2]","",names(ped))[1:10]
dim(ped.g)
ped.g[1:3,1:10,with=F]
names(rp)
)
dim(hap)
head(hap)
snps.p[1:10]
dim(rp.sub)
head(rp.sub)
 which(!gsub("\\.[1-2]","",names(ped)) %in% rp.sub$SNP)
 which(!gsub("\\.[1-2]","",names(ped.g)) %in% rp.sub$SNP)
which(dupliated(rp.sub$SNP))
which(duplicated(rp.sub$SNP))
rp.sub$SNP[which(duplicated(rp.sub$SNP))]
rp.sub$SNP[SNP %in% SNP[which(duplicated(rp.sub$SNP))],]
rp.sub$SNP[SNP %in% rp.sub$SNP[which(duplicated(rp.sub$SNP))],]
rp.sub[SNP %in% rp.sub$SNP[which(duplicated(rp.sub$SNP))],]
rp.sub[SNP %in% SNP[which(duplicated(rp.sub$SNP))],]
unique(rf$TYPE)
unique(rp$TYPE)
table(rp.sub$TYPE)
rp.sub[TYPE=="Multiallelic_SNP",]
alig.prob[V4  %in% SNP[which(duplicated(rp.sub$SNP))],]
alig.prob[V4  %in% rp.sub$SNP[which(duplicated(rp.sub$SNP))],]
all.dan[which(names(all.dan)  %in% rp.sub$SNP[which(duplicated(rp.sub$SNP))])]
unlist(multi.dan)
multi.a$SNP
multi.a[SNP %in% names(multi.dan)[-w],1,by=SNP]
multi.a
multi.a[,1,by=SNP]
which(duplicated(rp[SNP %in% names(multi.dan)[-w],SNP]))
rp[which(duplicated(rp[SNP %in% names(multi.dan)[-w],SNP])),]
 names(multi.dan)[-w]
rp[which(duplicated(rp[SNP %in% names(multi.dan)[-w],SNP])),]
duplicated(rp$SNP %in% names(multi.dan)[-w])
which(rp$SNP %in% names(multi.dan)[-w]))
which(rp$SNP %in% names(multi.dan)[-w])
w
rem
)
rem
rem
w
multi.dan
multi.dan[[w]]
multi.dan[[w]][[1]]
)
keep
rme2
dim(rp)
rp <- rp[-c(rem,rme2),]
c(rem,rme2)
dim(rp)
dim(rp)
dim(ped.g)
length(snps.p)
snps.p[1:3]
names(ped)snps.p[1:3]
names(ped)[snps.p[1:3]]
dim(pr.sub)
dim(rp.sub)
dim(rp.sub)
rp[which(!SNP %in% unique(gsub("\\.[1-2]","",names(ped)[snps.p]))),]
names(map)
map[b37 %in% rp[which(!SNP %in% unique(gsub("\\.[1-2]","",names(ped)[snps.p]))),position]]
dim(map)
map$allele
nchar(mat$allele)
nchar(map$allele)
which(nchar(map$allele)!=3)
map[which(nchar(map$allele)!=3),]
al.number[1:10]
mono
names(map)
map[mono,]
map[mono]
map[mono,]
mono[1:10]
multi.a[mono,]
]
map[refsnp_id %in% names(mono),
]
length(bi)
table(al.number)
bi
multi.dan[al.number==2]
map[refsnp_id %in% names(bi),]
tmp
strsplit(tmp$allele[1], "/")
unlist(strsplit(tmp$allele[1], "/"))
unlist(strsplit(tmp$allele[1], "/"))[1]
tmp
bi
multi.dan[bi]
length(multi.dan[bi])
length(multi.dan[bi])
tmp2 %in%  multi.dan[bi]
tmp2
tmp2 ==  multi.dan[bi]
alleles[[1]]
tmp2[[1]][alleles[[1]]]
alleles[[1]]
lapply(tmp2, paste0, collapse="/")
lapply(alleles, paste0, collapse="/")
sapply(alleles, paste0, collapse="/")
tmp
map
]
dim(map)
dim(ped)
ped-6
(982-6)/2
names(map)
dim(map)
head(map)
]
]
m <- map[nchar(map$allele)!=3), which=T]
m <- map[nchar(map$allele)!=3, which=T]
m
map <- fread(file="/mrc-bsu/scratch/ev250/ase-il2ra/objects/snpsB37no_I_D_map.txt")
dim(map)
head(map)
m <- map[nchar(map$allele)!=3, which=T]
m
length(m)
dim(multi.a)
length(al.numver)
length(al.number)
dim(multi.dan)
length(multi.dan)
which(! multi.a$refsnp_id %in% names(all.dan))
multi.a[which(! multi.a$refsnp_id %in% names(all.dan)),]
ped[,grep("rs41294601", names(ped),with=T]
ped[,grep("rs41294601", names(ped)),with=F]
which(names(all.dan)=="rs41294601")
i=mis0$refsnp_id[1]
i
u
which(names(mis.dan)==i)
which(names(all.dan)==i)
which(names(all.dan)==i)
names(map)
which(map$refsnp_id==i)
dim(map)
dim(ped.g)
map$refsnp_id
map$allele
dim(homo)
head(homo)
dim(alig.prob)
dim(geno)
geno[1,1:10,with=F]
1020/2
488-47-2
439-140
ped <- fread("/mrc-bsu/scratch/ev250/ase-il2ra/objects/snpsB37no_I_D_map.txt")
samp.m
geno.tag$ID
ped$ID
names(ped)
names(ped)
ped <- fread("/mrc-bsu/scratch/ev250/ase-il2ra/objects/genoB37no_I_D.txt")
dim(ped)
names(ped)[1:10]
geno.tag$ID
299+140
sam.A
sam.A3
haps.D
samples
samples3
53*2+6
haps.samp[,112:113,with=F]
haps.samp[,c(1,112:113),with=F]
haps.samp[,c(2,112:113),with=F]
haps.samp3[,c(2,112:113),with=F]
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
)
head(hm1[[1]])
tmp
tmp
]
tmp
tmp
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
tmp
tmp
tmp
sum(abs(tmp$N.x-tmp$N.y))
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
t1
t1
sum(t1$dif.sq)
sum(t1$dif)
class(s1)
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
S=10
maf1=m=c(-1.5, -1.5, -1.5, -.2)
 ph.diff(m=c(-1.5, -1.5, -1.5, -.2),cov=0.3, N=10000, n=100)
cov=0.3
H=N*2
cov=0.65
maf1
mean(ph.difference)
maf1
cov
N=10^5
H=N*2
maf1
cov
maf1 <- c(-1.5, -1, -1, -.2)
mean(ph.difference)
maf1 <- c(-1.5, -1, -.5, -.2)
cov
N
mean(ph.difference)
cov=0.3
mean(ph.difference)
cov=0.9
mean(ph.difference)
maf1
cov
cov=1
cov=0.95
i=.95
mean(sapply(1:10, ph.diff(m=c(-1.5, -1.5, -1, -.2),cov=i, N=10000, n=100)))
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
mean(sapply(1:10, ph.diff(m=c(-1.5, -1.5, -1, -.2),cov=i, N=10000, n=100)))
i
class(ph.diff)
class(ph.diff2)
plot(ph.comp, cov)
plot(ph.comp, covs)
plot(covs, ph.comp)
m2
m
m.mod
m
m
m[2] <- m2[1]
m
)
m.mod
head(pop.haps)
class(pop.haps)
data.table(pop.haps)
pop.freq
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
h1m[[1]]
hm1[[1]]
head(s1)
class9s1)
class(s1)
head(s1)
pop.freq
tmp
tmp
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
s
S=10
}
i
class(s1[[1]])
sapply(1:S, function(i) ph.diff2(hm1[[1]], rbind(s1[i]],s2[[i]]))
sapply(1:S, function(i) ph.diff2(hm1[[1]], rbind(s1[[i]],s2[[i]]))
)
length(s1)
sapply(1:9, function(i) ph.diff2(hm1[[1]], rbind(s1[[i]],s2[[i]]))
)
1<=S
10<=S
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
sapply(1:S, function(i) ph.diff2(hm1[[1]], rbind(s1[i]],s2[[i]]))
sapply(1:S, function(i) ph.diff2(hm1[[1]], rbind(s1[[i]],s2[[i]])))
length(s1)
s1[[1]]
lapply(s1,dim)
sapply(1:S, function(i) ph.diff2(hm1[[1]], rbind(s1[[i]],s2[[i]])))
summary(sapply(1:S, function(i) ph.diff2(hm1[[1]], rbind(s1[[i]],s2[[i]]))))
length(s1)
length(s2)
cov
rep(1:7,3)
install.packages('lme4')
inp
lenght(inp$pop)
length(inp$pop)
class(inp$pop[[1]])
length(inp$pop[[1]])
names(inp$pop[[1]])
inp$pop[[1]]$p
inp$sam[[1]]$p
inp$sam[[1]]
inp$pop[[1]]
pop.in[[1]]
pop.in[[1]]$pH
sam.in[[1]]$pH
inp$sam[[1]]$pH
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
maf1
maf1 <- c(-.5,-1,-.5,-.2)
cov
cov=0.2
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
tmp
H
cov
S
summary(sqd)
cov=0
summary(sqd)
cov
y=rbind(sam1,sam2)
y
tmp
source('/home/ev250/Bayesian_inf/trecase/Functions/stan.eff.R')
sqd
mean(sqd)
summary(sqd)
n=50
summary(sqd)
cov=0.2
length(sqd)
summary(sqd)
summary(sqd)
length(sqd)
summary(sqd)
maf1
maf1 <- c(-1.5,-1,-.5, -.2)
summary(sqd)
cov=0.6
summary(sqd)
n=100
summary(sqd)
n=75
summary(sqd)
summary(sqd)
H
N
cov
maf1
pre="diff"
dif=0.1
prefix
